document.addEventListener("DOMContentLoaded",(()=>{document.querySelector(".logout")?.addEventListener("click",(function(){window.location.href="index.html"}));const e=document.getElementById("datetime");function t(){if(!e)return;const t=new Date;e.innerText=t.toLocaleString("pt-BR",{dateStyle:"full",timeStyle:"medium"})}setInterval(t,1e3),t(),document.querySelectorAll(".menu-item.has-submenu > .menu-link").forEach((e=>{const t=e.nextElementSibling;t&&(t.style.overflow="hidden",t.style.maxHeight="0",t.style.display="none",t.style.transition="max-height 0.3s ease",e.addEventListener("click",(e=>{e.preventDefault(),document.querySelectorAll(".submenu").forEach((e=>{e!==t&&(e.style.maxHeight="0",setTimeout((()=>e.style.display="none"),300))})),"0px"===t.style.maxHeight||""===t.style.maxHeight?(t.style.display="flex",t.style.flexDirection="column",t.style.maxHeight=t.scrollHeight+"px"):(t.style.maxHeight="0",setTimeout((()=>t.style.display="none"),300))})))}));let n=[{nome:"Morador 1",apt:"101",torre:"Mykonos",veiculo:"Carro",contato:"(11) 99999-8888"},{nome:"Morador 2",apt:"202",torre:"Santorini",veiculo:"Moto",contato:"morador2@email.com"},{nome:"Morador 3",apt:"303",torre:"Mykonos",veiculo:"Carro",contato:"(11) 98888-7777"}],o=[{tipo:"Carro",marca:"Chevrolet",modelo:"Onix",placa:"ABC-1234",apt:"101"},{tipo:"Moto",marca:"Honda",modelo:"CG 160",placa:"XYZ-5678",apt:"202"},{tipo:"Carro",marca:"Wolks",modelo:"Gol",placa:"QWE-7890",apt:"303"}],a=[{nome:"João Silva",funcao:"Portaria",dias:"Seg a Sex",horario:"07:00-15:00"},{nome:"Maria Souza",funcao:"Limpeza",dias:"Todos os dias",horario:"08:00-16:00"},{nome:"Carlos Lima",funcao:"Segurança",dias:"Seg a Sex",horario:"15:00-23:00"}],r={Mykonos:[],Santorini:[],Creta:[],Paros:[]};const d={morador:document.getElementById("moradorModal"),veiculo:document.getElementById("veiculoModal"),funcionario:document.getElementById("funcionarioModal"),entrega:document.getElementById("entregaModal"),mensagem:document.getElementById("mensagemModal")};let c=null,l="";function i(e,t,n=null){c=n;const o=d[e];if(!o)return;o.style.display="block";const a=o.querySelector("h2").id;document.getElementById(a).innerText="add"===t?`Adicionar ${e}`:`Alterar ${e}`;const r=o.querySelector("form");"edit"===t&&n?Array.from(n.children).forEach(((e,t)=>{const n=r[t];n&&(n.value=e.innerText)})):r?.reset()}function s(){const e=document.getElementById("content-area");e&&(e.innerHTML='<div class="cards"><div class="card">Aviso 1</div><div class="card">Aviso 2</div><div class="card">Aviso 3</div></div>')}function u(){const e=document.getElementById("content-area");if(!e)return;e.innerHTML=`\n            <h2>Moradores</h2>\n            <div class="moradores-actions" style="display:flex; justify-content:space-between; margin-bottom:10px;">\n                <div>\n                    <button id="btnAddMorador" class="action-btn">Adicionar</button>\n                    <button id="btnEditMorador" class="action-btn">Alterar</button>\n                </div>\n                <div>\n                    <button id="btnBackMorador" class="action-btn" style="background:#95a5a6;">Voltar</button>\n                </div>\n            </div>\n            <div class="moradores-search">\n                <input type="text" id="searchNome" placeholder="Pesquisar por nome">\n                <input type="text" id="searchTorre" placeholder="Pesquisar por torre">\n                <input type="text" id="searchVeiculo" placeholder="Pesquisar por veículo">\n            </div>\n            <div class="tabela-container animate">\n                <table class="tabela-moradores">\n                    <thead>\n                        <tr><th>Nome</th><th>Apartamento</th><th>Torre</th><th>Veículo</th><th>Contato</th></tr>\n                    </thead>\n                    <tbody id="moradoresBody">\n                        ${n.map((e=>`<tr>\n                            <td>${e.nome}</td><td>${e.apt}</td><td>${e.torre}</td><td>${e.veiculo}</td><td>${e.contato}</td>\n                        </tr>`)).join("")}\n                    </tbody>\n                </table>\n            </div>\n        `;const t=document.querySelectorAll(".tabela-moradores tbody tr");t.forEach((e=>e.addEventListener("click",(()=>{t.forEach((e=>e.classList.remove("selected"))),e.classList.add("selected")})))),document.getElementById("btnAddMorador")?.addEventListener("click",(()=>i("morador","add"))),document.getElementById("btnEditMorador")?.addEventListener("click",(()=>{const e=document.querySelector(".tabela-moradores tr.selected");if(!e)return alert("Selecione um morador para alterar");i("morador","edit",e)})),document.getElementById("btnBackMorador")?.addEventListener("click",s),["searchNome","searchTorre","searchVeiculo"].forEach((e=>{document.getElementById(e)?.addEventListener("input",m)}))}function m(){const e=document.getElementById("searchNome")?.value.toLowerCase()||"",t=document.getElementById("searchTorre")?.value.toLowerCase()||"",n=document.getElementById("searchVeiculo")?.value.toLowerCase()||"";document.querySelectorAll(".tabela-moradores tbody tr").forEach((o=>{const a=o.children;o.style.display=a[0].innerText.toLowerCase().includes(e)&&a[2].innerText.toLowerCase().includes(t)&&a[3].innerText.toLowerCase().includes(n)?"":"none"}))}function y(){const e=document.getElementById("content-area");if(!e)return;e.innerHTML=`\n            <h2>Veículos</h2>\n            <div class="moradores-actions" style="display:flex; justify-content:space-between; margin-bottom:10px;">\n                <div>\n                    <button id="btnAddVeiculo" class="action-btn">Adicionar</button>\n                    <button id="btnEditVeiculo" class="action-btn">Alterar</button>\n                </div>\n                <div>\n                    <button id="btnBackVeiculo" class="action-btn" style="background:#95a5a6;">Voltar</button>\n                </div>\n            </div>\n            <div class="moradores-search">\n                <input type="text" id="searchTipo" placeholder="Pesquisar por tipo">\n                <input type="text" id="searchMarca" placeholder="Pesquisar por marca">\n                <input type="text" id="searchModelo" placeholder="Pesquisar por modelo">\n                <input type="text" id="searchPlaca" placeholder="Pesquisar por placa">\n                <input type="text" id="searchApto" placeholder="Pesquisar por apartamento">\n            </div>\n            <div class="tabela-container animate">\n                <table class="tabela-moradores">\n                    <thead>\n                        <tr><th>Tipo</th><th>Marca</th><th>Modelo</th><th>Placa</th><th>Apartamento</th></tr>\n                    </thead>\n                    <tbody id="veiculosBody">\n                        ${o.map((e=>`<tr>\n                            <td>${e.tipo}</td><td>${e.marca}</td><td>${e.modelo}</td><td>${e.placa}</td><td>${e.apt}</td>\n                        </tr>`)).join("")}\n                    </tbody>\n                </table>\n            </div>\n        `;const t=document.querySelectorAll(".tabela-moradores tbody tr");t.forEach((e=>e.addEventListener("click",(()=>{t.forEach((e=>e.classList.remove("selected"))),e.classList.add("selected")})))),document.getElementById("btnAddVeiculo")?.addEventListener("click",(()=>i("veiculo","add"))),document.getElementById("btnEditVeiculo")?.addEventListener("click",(()=>{const e=document.querySelector(".tabela-moradores tr.selected");if(!e)return alert("Selecione um veículo para alterar");i("veiculo","edit",e)})),document.getElementById("btnBackVeiculo")?.addEventListener("click",s),["searchTipo","searchMarca","searchModelo","searchPlaca","searchApto"].forEach((e=>{document.getElementById(e)?.addEventListener("input",h)}))}function h(){const e=document.getElementById("searchTipo")?.value.toLowerCase()||"",t=document.getElementById("searchMarca")?.value.toLowerCase()||"",n=document.getElementById("searchModelo")?.value.toLowerCase()||"",o=document.getElementById("searchPlaca")?.value.toLowerCase()||"",a=document.getElementById("searchApto")?.value.toLowerCase()||"";document.querySelectorAll(".tabela-moradores tbody tr").forEach((r=>{const d=r.children;r.style.display=d[0].innerText.toLowerCase().includes(e)&&d[1].innerText.toLowerCase().includes(t)&&d[2].innerText.toLowerCase().includes(n)&&d[3].innerText.toLowerCase().includes(o)&&d[4].innerText.toLowerCase().includes(a)?"":"none"}))}function v(){const e=document.getElementById("content-area");if(!e)return;e.innerHTML=`\n            <h2>Funcionários</h2>\n            <div class="moradores-actions" style="display:flex; justify-content:space-between; margin-bottom:10px;">\n                <div>\n                    <button id="btnAddFunc" class="action-btn">Adicionar</button>\n                    <button id="btnEditFunc" class="action-btn">Alterar</button>\n                </div>\n                <div>\n                    <button id="btnBackFunc" class="action-btn" style="background:#95a5a6;">Voltar</button>\n                </div>\n            </div>\n            <div class="moradores-search">\n                <input type="text" id="searchNomeFunc" placeholder="Pesquisar por nome">\n                <input type="text" id="searchFuncao" placeholder="Pesquisar por função">\n                <input type="text" id="searchDias" placeholder="Pesquisar por dias">\n                <input type="text" id="searchHorario" placeholder="Pesquisar por horário">\n            </div>\n            <div class="tabela-container animate">\n                <table class="tabela-moradores">\n                    <thead>\n                        <tr><th>Nome</th><th>Função</th><th>Dias</th><th>Horário</th></tr>\n                    </thead>\n                    <tbody id="funcionariosBody">\n                        ${a.map((e=>`<tr>\n                            <td>${e.nome}</td><td>${e.funcao}</td><td>${e.dias}</td><td>${e.horario}</td>\n                        </tr>`)).join("")}\n                    </tbody>\n                </table>\n            </div>\n        `;const t=document.querySelectorAll(".tabela-moradores tbody tr");t.forEach((e=>e.addEventListener("click",(()=>{t.forEach((e=>e.classList.remove("selected"))),e.classList.add("selected")})))),document.getElementById("btnAddFunc")?.addEventListener("click",(()=>i("funcionario","add"))),document.getElementById("btnEditFunc")?.addEventListener("click",(()=>{const e=document.querySelector(".tabela-moradores tr.selected");if(!e)return alert("Selecione um funcionário para alterar");i("funcionario","edit",e)})),document.getElementById("btnBackFunc")?.addEventListener("click",s),["searchNomeFunc","searchFuncao","searchDias","searchHorario"].forEach((e=>{document.getElementById(e)?.addEventListener("input",p)}))}function p(){const e=document.getElementById("searchNomeFunc")?.value.toLowerCase()||"",t=document.getElementById("searchFuncao")?.value.toLowerCase()||"",n=document.getElementById("searchDias")?.value.toLowerCase()||"",o=document.getElementById("searchHorario")?.value.toLowerCase()||"";document.querySelectorAll(".tabela-moradores tbody tr").forEach((a=>{const r=a.children;a.style.display=r[0].innerText.toLowerCase().includes(e)&&r[1].innerText.toLowerCase().includes(t)&&r[2].innerText.toLowerCase().includes(n)&&r[3].innerText.toLowerCase().includes(o)?"":"none"}))}function E(e){document.getElementById("content-area").innerHTML=`\n            <h2>Selecione a torre - ${"entrega"===e?"Registrar Entrega":"Enviar Mensagem"}</h2>\n            <div class="cards">\n                <div class="card" data-torre="Mykonos">Mykonos</div>\n                <div class="card" data-torre="Santorini">Santorini</div>\n                <div class="card" data-torre="Creta">Creta</div>\n                <div class="card disabled" data-torre="Paros" style="opacity:0.5; cursor:not-allowed;">Paros</div>\n            </div>\n        `,document.querySelectorAll("#content-area .card").forEach((t=>{t.classList.contains("disabled")||t.addEventListener("click",(()=>{const o=t.dataset.torre;l=o,"entrega"===e?b(o):function(e){const t=document.getElementById("content-area");t.innerHTML=`\n            <h2>Enviar Mensagem - ${e}</h2>\n            <div class="moradores-actions">\n                <div>\n                    <input type="checkbox" id="checkAll"> Selecionar Todos\n                </div>\n                <div>\n                    <button id="btnBackMsg" class="action-btn" style="background:#95a5a6;">Voltar</button>\n                </div>\n            </div>\n            <form id="mensagemForm">\n                <div class="tabela-container animate">\n                    <table class="tabela-moradores">\n                        <thead><tr><th>Selecionar</th><th>Nome</th><th>Apt</th><th>Torre</th><th>Enviado Aviso</th></tr></thead>\n                        <tbody>\n                            ${n.filter((t=>t.torre===e)).map(((e,t)=>`\n                                <tr>\n                                    <td><input type="checkbox" class="chkMorador" data-index="${t}"></td>\n                                    <td>${e.nome}</td>\n                                    <td>${e.apt}</td>\n                                    <td>${e.torre}</td>\n                                    <td>${Object.values(r).flat().some((t=>t.nome===e.nome))?"Sim":"Não"}</td>\n                                </tr>\n                            `)).join("")}\n                        </tbody>\n                    </table>\n                </div>\n                <button type="submit" class="action-btn">Enviar Mensagem</button>\n            </form>\n        `,document.getElementById("btnBackMsg")?.addEventListener("click",s),document.getElementById("checkAll")?.addEventListener("change",(function(){document.querySelectorAll(".chkMorador").forEach((e=>e.checked=this.checked))})),document.getElementById("mensagemForm")?.addEventListener("submit",(e=>{e.preventDefault();const t=Array.from(document.querySelectorAll(".chkMorador")).filter((e=>e.checked)).map((e=>n[e.dataset.index].nome));if(0===t.length)return alert("Selecione pelo menos um morador");alert("Mensagem enviada para: "+t.join(", "))}))}(o)}))}))}function b(e){document.getElementById("content-area").innerHTML=`\n            <h2>Entregas - ${e}</h2>\n            <div class="moradores-actions">\n                <button id="btnAddEntrega" class="action-btn">Registrar Entrega</button>\n                <button id="btnBackEntrega" class="action-btn" style="background:#95a5a6;">Voltar</button>\n            </div>\n            <div class="tabela-container animate">\n                <table class="tabela-moradores">\n                    <thead><tr><th>Morador</th><th>Apt</th><th>Entrega</th><th>Data/Hora</th></tr></thead>\n                    <tbody>\n                        ${r[e].map((e=>`<tr><td>${e.nome}</td><td>${e.apt}</td><td>${e.tipo}</td><td>${e.data}</td></tr>`)).join("")}\n                    </tbody>\n                </table>\n            </div>\n        `,document.getElementById("btnBackEntrega")?.addEventListener("click",(()=>E("entrega"))),document.getElementById("btnAddEntrega")?.addEventListener("click",(()=>{d.entrega.style.display="block",document.getElementById("entregaForm").reset(),document.getElementById("entregaData").value=(new Date).toLocaleString("pt-BR",{dateStyle:"short",timeStyle:"short"})}))}document.querySelectorAll(".modal .close").forEach((e=>e.onclick=()=>e.closest(".modal").style.display="none")),window.addEventListener("click",(e=>{Object.values(d).forEach((t=>{e.target===t&&(t.style.display="none")}))})),s(),document.getElementById("link-moradores")?.addEventListener("click",(e=>{e.preventDefault(),u()})),document.getElementById("moradorForm")?.addEventListener("submit",(e=>{e.preventDefault();const t={nome:document.getElementById("morNome").value,apt:document.getElementById("morApto").value,torre:document.getElementById("morTorre").value,veiculo:document.getElementById("morVeiculo").value,contato:document.getElementById("morContato").value};c?(Array.from(c.children).forEach(((e,n)=>e.innerText=Object.values(t)[n])),c=null):(n.push(t),u()),d.morador.style.display="none"})),document.getElementById("link-veiculos")?.addEventListener("click",(e=>{e.preventDefault(),y()})),document.getElementById("veiculoForm")?.addEventListener("submit",(e=>{e.preventDefault();const t={tipo:document.getElementById("veiTipo").value,marca:document.getElementById("veiMarca").value,modelo:document.getElementById("veiModelo").value,placa:document.getElementById("veiPlaca").value,apt:document.getElementById("veiApto").value};c?(Array.from(c.children).forEach(((e,n)=>e.innerText=Object.values(t)[n])),c=null):(o.push(t),y()),d.veiculo.style.display="none"})),document.getElementById("link-funcionarios")?.addEventListener("click",(e=>{e.preventDefault(),v()})),document.getElementById("funcionarioForm")?.addEventListener("submit",(e=>{e.preventDefault();const t={nome:document.getElementById("funcNome").value,funcao:document.getElementById("funcFuncao").value,dias:document.getElementById("funcDias").value,horario:document.getElementById("funcHorario").value};c?(Array.from(c.children).forEach(((e,n)=>e.innerText=Object.values(t)[n])),c=null):(a.push(t),v()),d.funcionario.style.display="none"})),document.getElementById("link-registrar-entrega")?.addEventListener("click",(e=>{e.preventDefault(),E("entrega")})),document.getElementById("link-enviar-mensagem")?.addEventListener("click",(e=>{e.preventDefault(),E("mensagem")})),document.getElementById("entregaForm")?.addEventListener("submit",(e=>{e.preventDefault();const t={nome:document.getElementById("entregaNome").value,apt:document.getElementById("entregaApto").value,tipo:document.getElementById("entregaTipo").value,data:document.getElementById("entregaData").value};r[l].push(t),d.entrega.style.display="none",b(l)}))}));